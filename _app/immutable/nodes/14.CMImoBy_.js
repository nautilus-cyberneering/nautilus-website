import{t as b,a as N,c as qe}from"../chunks/DVzJEUFw.js";import{aL as Te,z as Re,W as Ne,ao as Fe,p as ue,_ as D,$ as it,ax as Kt,aI as Wt,N as k,aa as be,ay as Je,c as E,s as X,r as B,a as ce,f as ae,t as He,aH as Gt,Z as Ke}from"../chunks/KakmFDlB.js";import{i as Q}from"../chunks/DW7yeU_M.js";import{e as Pt,i as Ct}from"../chunks/Cve7IKY8.js";import{B as We}from"../chunks/C9ROuMIc.js";import"../chunks/C8Lo1z3I.js";import{l as Ge,f as Ut}from"../chunks/iMGu8jsh.js";import{h as zt}from"../chunks/BY6YOE9H.js";import{r as Ue,s as Ve}from"../chunks/DJytIM3o.js";import{_ as Ze,b as Qe}from"../chunks/3PoFmJtc.js";import{i as Xe}from"../chunks/C0An1VHR.js";import{p as Vt}from"../chunks/CKtzrIAD.js";import{a as Ye,s as ti}from"../chunks/DKVzS31c.js";import{I as Zt}from"../chunks/NIsqP3W_.js";import{t as ei}from"../chunks/0evbJfYt.js";import{o as ii,a as ni}from"../chunks/eEqlKqnc.js";import{H as si}from"../chunks/D4RYC4lC.js";import{W as ri}from"../chunks/CiwQBv7X.js";function hi(t,e,i=e){var s=Te();Ge(t,"input",n=>{var r=n?t.defaultValue:t.value;if(r=Mt(t)?St(r):r,i(r),s&&r!==(r=e())){var h=t.selectionStart,l=t.selectionEnd;t.value=r??"",l!==null&&(t.selectionStart=h,t.selectionEnd=Math.min(l,t.value.length))}}),(Re&&t.defaultValue!==t.value||Ne(e)==null&&t.value)&&i(Mt(t)?St(t.value):t.value),Fe(()=>{var n=e();Mt(t)&&n===St(t.value)||t.type==="date"&&!n&&!t.value||n!==t.value&&(t.value=n??"")})}function Mt(t){var e=t.type;return e==="number"||e==="range"}function St(t){return t===""?null:+t}var w;function L(t,e,i){const s=typeof i,n=typeof t;if(s!=="undefined"){if(n!=="undefined"){if(i){if(n==="function"&&s===n)return function(l){return t(i(l))};if(e=t.constructor,e===i.constructor){if(e===Array)return i.concat(t);if(e===Map){var r=new Map(i);for(var h of t)r.set(h[0],h[1]);return r}if(e===Set){h=new Set(i);for(r of t.values())h.add(r);return h}}}return t}return i}return n==="undefined"?e:t}function P(){return Object.create(null)}function $(t){return typeof t=="string"}function ht(t){return typeof t=="object"}function oi(t){const e=[];for(const i of t.keys())e.push(i);return e}function ot(t,e){if($(e))t=t[e];else for(let i=0;t&&i<e.length;i++)t=t[e[i]];return t}function li(t){let e=0;for(let i=0,s;i<t.length;i++)(s=t[i])&&e<s.length&&(e=s.length);return e}const fi=/[^\p{L}\p{N}]+/u,ui=/(\d{3})/g,ci=/(\D)(\d{3})/g,ai=/(\d{3})(\D)/g,Qt=/[\u0300-\u036f]/g;function gt(t={}){if(!this||this.constructor!==gt)return new gt(...arguments);if(arguments.length)for(t=0;t<arguments.length;t++)this.assign(arguments[t]);else this.assign(t)}w=gt.prototype;w.assign=function(t){this.normalize=L(t.normalize,!0,this.normalize);let e=t.include,i=e||t.exclude||t.split,s;if(i||i===""){if(typeof i=="object"&&i.constructor!==RegExp){let n="";s=!e,e||(n+="\\p{Z}"),i.letter&&(n+="\\p{L}"),i.number&&(n+="\\p{N}",s=!!e),i.symbol&&(n+="\\p{S}"),i.punctuation&&(n+="\\p{P}"),i.control&&(n+="\\p{C}"),(i=i.char)&&(n+=typeof i=="object"?i.join(""):i);try{this.split=new RegExp("["+(e?"^":"")+n+"]+","u")}catch{this.split=/\s+/}}else this.split=i,s=i===!1||2>"a1a".split(i).length;this.numeric=L(t.numeric,s)}else{try{this.split=L(this.split,fi)}catch{this.split=/\s+/}this.numeric=L(t.numeric,L(this.numeric,!0))}if(this.prepare=L(t.prepare,null,this.prepare),this.finalize=L(t.finalize,null,this.finalize),i=t.filter,this.filter=typeof i=="function"?i:L(i&&new Set(i),null,this.filter),this.dedupe=L(t.dedupe,!0,this.dedupe),this.matcher=L((i=t.matcher)&&new Map(i),null,this.matcher),this.mapper=L((i=t.mapper)&&new Map(i),null,this.mapper),this.stemmer=L((i=t.stemmer)&&new Map(i),null,this.stemmer),this.replacer=L(t.replacer,null,this.replacer),this.minlength=L(t.minlength,1,this.minlength),this.maxlength=L(t.maxlength,1024,this.maxlength),this.rtl=L(t.rtl,!1,this.rtl),(this.cache=i=L(t.cache,!0,this.cache))&&(this.H=null,this.S=typeof i=="number"?i:2e5,this.B=new Map,this.G=new Map,this.L=this.K=128),this.h="",this.M=null,this.A="",this.N=null,this.matcher)for(const n of this.matcher.keys())this.h+=(this.h?"|":"")+n;if(this.stemmer)for(const n of this.stemmer.keys())this.A+=(this.A?"|":"")+n;return this};w.addStemmer=function(t,e){return this.stemmer||(this.stemmer=new Map),this.stemmer.set(t,e),this.A+=(this.A?"|":"")+t,this.N=null,this.cache&&W(this),this};w.addFilter=function(t){return typeof t=="function"?this.filter=t:(this.filter||(this.filter=new Set),this.filter.add(t)),this.cache&&W(this),this};w.addMapper=function(t,e){return typeof t=="object"?this.addReplacer(t,e):1<t.length?this.addMatcher(t,e):(this.mapper||(this.mapper=new Map),this.mapper.set(t,e),this.cache&&W(this),this)};w.addMatcher=function(t,e){return typeof t=="object"?this.addReplacer(t,e):2>t.length&&(this.dedupe||this.mapper)?this.addMapper(t,e):(this.matcher||(this.matcher=new Map),this.matcher.set(t,e),this.h+=(this.h?"|":"")+t,this.M=null,this.cache&&W(this),this)};w.addReplacer=function(t,e){return typeof t=="string"?this.addMatcher(t,e):(this.replacer||(this.replacer=[]),this.replacer.push(t,e),this.cache&&W(this),this)};w.encode=function(t){if(this.cache&&t.length<=this.K)if(this.H){if(this.B.has(t))return this.B.get(t)}else this.H=setTimeout(W,50,this);this.normalize&&(typeof this.normalize=="function"?t=this.normalize(t):t=Qt?t.normalize("NFKD").replace(Qt,"").toLowerCase():t.toLowerCase()),this.prepare&&(t=this.prepare(t)),this.numeric&&3<t.length&&(t=t.replace(ci,"$1 $2").replace(ai,"$1 $2").replace(ui,"$1 "));const e=!(this.dedupe||this.mapper||this.filter||this.matcher||this.stemmer||this.replacer);let i=[],s=this.split||this.split===""?t.split(this.split):t;for(let r=0,h,l;r<s.length;r++)if((h=l=s[r])&&!(h.length<this.minlength||h.length>this.maxlength)){if(e)i.push(h);else if(!this.filter||(typeof this.filter=="function"?this.filter(h):!this.filter.has(h))){if(this.cache&&h.length<=this.L)if(this.H){var n=this.G.get(h);if(n||n===""){n&&i.push(n);continue}}else this.H=setTimeout(W,50,this);if(this.stemmer&&2<h.length&&(this.N||(this.N=new RegExp("(?!^)("+this.A+")$")),n=h,h=h.replace(this.N,o=>this.stemmer.get(o)),n!==h&&this.filter&&h.length>=this.minlength&&(typeof this.filter=="function"?!this.filter(h):this.filter.has(h))&&(h="")),h&&(this.mapper||this.dedupe&&1<h.length)){n="";for(let o=0,f="",c,u;o<h.length;o++)c=h.charAt(o),c===f&&this.dedupe||((u=this.mapper&&this.mapper.get(c))||u===""?u===f&&this.dedupe||!(f=u)||(n+=u):n+=f=c);h=n}if(this.matcher&&1<h.length&&(this.M||(this.M=new RegExp("("+this.h+")","g")),h=h.replace(this.M,o=>this.matcher.get(o))),h&&this.replacer)for(n=0;h&&n<this.replacer.length;n+=2)h=h.replace(this.replacer[n],this.replacer[n+1]);this.cache&&l.length<=this.L&&(this.G.set(l,h),this.G.size>this.S&&(this.G.clear(),this.L=this.L/1.1|0)),h&&i.push(h)}}return this.finalize&&(i=this.finalize(i)||i),this.cache&&t.length<=this.K&&(this.B.set(t,i),this.B.size>this.S&&(this.B.clear(),this.K=this.K/1.1|0)),i};function W(t){t.H=null,t.B.clear(),t.G.clear()}let Z,nt;async function di(t){t=t.data;var e=t.task;const i=t.id;let s=t.args;switch(e){case"init":nt=t.options||{},(e=t.factory)?(Function("return "+e)()(self),Z=new self.FlexSearch.Index(nt),delete self.FlexSearch):Z=new T(nt),postMessage({id:i});break;default:let n;e==="export"&&(s[1]?(s[0]=nt.export,s[2]=0,s[3]=1):s=null),e==="import"?s[0]&&(t=await nt.import.call(Z,s[0]),Z.import(s[0],t)):(n=s&&Z[e].apply(Z,s))&&n.then&&(n=await n),postMessage(e==="search"?{id:i,msg:n}:{id:i})}}function $t(t){st.call(t,"add"),st.call(t,"append"),st.call(t,"search"),st.call(t,"update"),st.call(t,"remove")}let Lt,Xt,dt;function gi(){Lt=dt=0}function st(t){this[t+"Async"]=function(){const e=arguments;var i=e[e.length-1];let s;if(typeof i=="function"&&(s=i,delete e[e.length-1]),Lt?dt||(dt=Date.now()-Xt>=this.priority*this.priority*3):(Lt=setTimeout(gi,0),Xt=Date.now()),dt){const r=this;return new Promise(h=>{setTimeout(function(){h(r[t+"Async"].apply(r,e))},0)})}const n=this[t].apply(this,e);return i=n.then?n:new Promise(r=>r(n)),s&&i.then(s),i}}let Y=0;function lt(t={}){function e(h){function l(o){o=o.data||o;const f=o.id,c=f&&n.h[f];c&&(c(o.msg),delete n.h[f])}if(this.worker=h,this.h=P(),this.worker)return s?this.worker.on("message",l):this.worker.onmessage=l,t.config?new Promise(function(o){n.h[++Y]=function(){o(n),1e9<Y&&(Y=0)},n.worker.postMessage({id:Y,task:"init",factory:i,options:t})}):(this.worker.postMessage({task:"init",factory:i,options:t}),this.priority=t.priority||4,this)}if(!this||this.constructor!==lt)return new lt(t);let i=typeof self<"u"?self._factory:typeof window<"u"?window._factory:null;i&&(i=i.toString());const s=typeof window>"u",n=this,r=pi(i,s,t.worker);return r.then?r.then(function(h){return e.call(n,h)}):e.call(this,r)}J("add");J("append");J("search");J("update");J("remove");J("clear");J("export");J("import");$t(lt.prototype);function J(t){lt.prototype[t]=function(){const e=this,i=[].slice.call(arguments);var s=i[i.length-1];let n;return typeof s=="function"&&(n=s,i.pop()),s=new Promise(function(r){t==="export"&&typeof i[0]=="function"&&(i[0]=null),e.h[++Y]=r,e.worker.postMessage({task:t,id:Y,args:i})}),n?(s.then(n),this):s}}function pi(t,e,i){return e?typeof module<"u"?new(require("worker_threads")).Worker(__dirname+"/worker/node.js"):Ze(()=>import("../chunks/BIHI7g3E.js"),[],import.meta.url).then(function(s){return new s.Worker(import.meta.dirname+"/node/node.mjs")}):t?new window.Worker(URL.createObjectURL(new Blob(["onmessage="+di.toString()],{type:"text/javascript"}))):new window.Worker(typeof i=="string"?i:import.meta.url.replace("/worker.js","/worker/worker.js").replace("flexsearch.bundle.module.min.js","module/worker/worker.js"),{type:"module"})}function qt(t,e=0){let i=[],s=[];e&&(e=25e4/e*5e3|0);for(const n of t.entries())s.push(n),s.length===e&&(i.push(s),s=[]);return s.length&&i.push(s),i}function Tt(t,e){e||(e=new Map);for(let i=0,s;i<t.length;i++)s=t[i],e.set(s[0],s[1]);return e}function de(t,e=0){let i=[],s=[];e&&(e=25e4/e*1e3|0);for(const n of t.entries())s.push([n[0],qt(n[1])[0]]),s.length===e&&(i.push(s),s=[]);return s.length&&i.push(s),i}function ge(t,e){e||(e=new Map);for(let i=0,s,n;i<t.length;i++)s=t[i],n=e.get(s[0]),e.set(s[0],Tt(s[1],n));return e}function pe(t){let e=[],i=[];for(const s of t.keys())i.push(s),i.length===25e4&&(e.push(i),i=[]);return i.length&&e.push(i),e}function me(t,e){e||(e=new Set);for(let i=0;i<t.length;i++)e.add(t[i]);return e}function pt(t,e,i,s,n,r,h=0){const l=s&&s.constructor===Array;var o=l?s.shift():s;if(!o)return this.export(t,e,n,r+1);if((o=t((e?e+".":"")+(h+1)+"."+i,JSON.stringify(o)))&&o.then){const f=this;return o.then(function(){return pt.call(f,t,e,i,l?s:null,n,r,h+1)})}return pt.call(this,t,e,i,l?s:null,n,r,h+1)}function Yt(t,e){let i="";for(const s of t.entries()){t=s[0];const n=s[1];let r="";for(let h=0,l;h<n.length;h++){l=n[h]||[""];let o="";for(let f=0;f<l.length;f++)o+=(o?",":"")+(e==="string"?'"'+l[f]+'"':l[f]);o="["+o+"]",r+=(r?",":"")+o}r='["'+t+'",['+r+"]]",i+=(i?",":"")+r}return i}function te(t,e,i,s){let n=[];for(let r=0,h;r<t.index.length;r++)if(h=t.index[r],e>=h.length)e-=h.length;else{e=h[s?"splice":"slice"](e,i);const l=e.length;if(l&&(n=n.length?n.concat(e):e,i-=l,s&&(t.length-=l),!i))break;e=0}return n}function G(t){if(!this||this.constructor!==G)return new G(t);this.index=t?[t]:[],this.length=t?t.length:0;const e=this;return new Proxy([],{get(i,s){if(s==="length")return e.length;if(s==="push")return function(n){e.index[e.index.length-1].push(n),e.length++};if(s==="pop")return function(){if(e.length)return e.length--,e.index[e.index.length-1].pop()};if(s==="indexOf")return function(n){let r=0;for(let h=0,l,o;h<e.index.length;h++){if(l=e.index[h],o=l.indexOf(n),0<=o)return r+o;r+=l.length}return-1};if(s==="includes")return function(n){for(let r=0;r<e.index.length;r++)if(e.index[r].includes(n))return!0;return!1};if(s==="slice")return function(n,r){return te(e,n||0,r||e.length,!1)};if(s==="splice")return function(n,r){return te(e,n||0,r||e.length,!0)};if(s==="constructor")return Array;if(typeof s!="symbol")return(i=e.index[s/2**31|0])&&i[s]},set(i,s,n){return i=s/2**31|0,(e.index[i]||(e.index[i]=[]))[s]=n,e.length++,!0}})}G.prototype.clear=function(){this.index.length=0};G.prototype.destroy=function(){this.proxy=this.index=null};G.prototype.push=function(){};function R(t=8){if(!this||this.constructor!==R)return new R(t);this.index=P(),this.h=[],this.size=0,32<t?(this.B=ye,this.A=BigInt(t)):(this.B=we,this.A=t)}R.prototype.get=function(t){const e=this.index[this.B(t)];return e&&e.get(t)};R.prototype.set=function(t,e){var i=this.B(t);let s=this.index[i];s?(i=s.size,s.set(t,e),(i-=s.size)&&this.size++):(this.index[i]=s=new Map([[t,e]]),this.h.push(s),this.size++)};function q(t=8){if(!this||this.constructor!==q)return new q(t);this.index=P(),this.h=[],this.size=0,32<t?(this.B=ye,this.A=BigInt(t)):(this.B=we,this.A=t)}q.prototype.add=function(t){var e=this.B(t);let i=this.index[e];i?(e=i.size,i.add(t),(e-=i.size)&&this.size++):(this.index[e]=i=new Set([t]),this.h.push(i),this.size++)};w=R.prototype;w.has=q.prototype.has=function(t){const e=this.index[this.B(t)];return e&&e.has(t)};w.delete=q.prototype.delete=function(t){const e=this.index[this.B(t)];e&&e.delete(t)&&this.size--};w.clear=q.prototype.clear=function(){this.index=P(),this.h=[],this.size=0};w.values=q.prototype.values=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].values())yield e};w.keys=q.prototype.keys=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].keys())yield e};w.entries=q.prototype.entries=function*(){for(let t=0;t<this.h.length;t++)for(let e of this.h[t].entries())yield e};function we(t){let e=2**this.A-1;if(typeof t=="number")return t&e;let i=0,s=this.A+1;for(let n=0;n<t.length;n++)i=(i*s^t.charCodeAt(n))&e;return this.A===32?i+2**31:i}function ye(t){let e=BigInt(2)**this.A-BigInt(1);var i=typeof t;if(i==="bigint")return t&e;if(i==="number")return BigInt(t)&e;i=BigInt(0);let s=this.A+BigInt(1);for(let n=0;n<t.length;n++)i=(i*s^BigInt(t.charCodeAt(n)))&e;return i}tt.prototype.add=function(t,e,i){if(ht(t)&&(e=t,t=ot(e,this.key)),e&&(t||t===0)){if(!i&&this.reg.has(t))return this.update(t,e);for(let l=0,o;l<this.field.length;l++){o=this.D[l];var s=this.index.get(this.field[l]);if(typeof o=="function"){var n=o(e);n&&s.add(t,n,!1,!0)}else n=o.I,(!n||n(e))&&(o.constructor===String?o=[""+o]:$(o)&&(o=[o]),It(e,o,this.J,0,s,t,o[0],i))}if(this.tag)for(s=0;s<this.F.length;s++){var r=this.F[s];n=this.tag.get(this.R[s]);let l=P();if(typeof r=="function"){if(r=r(e),!r)continue}else{var h=r.I;if(h&&!h(e))continue;r.constructor===String&&(r=""+r),r=ot(e,r)}if(n&&r){$(r)&&(r=[r]);for(let o=0,f,c;o<r.length;o++)if(f=r[o],!l[f]&&(l[f]=1,(h=n.get(f))?c=h:n.set(f,c=[]),!i||!c.includes(t))){if(c.length===2**31-1){if(h=new G(c),this.fastupdate)for(let u of this.reg.values())u.includes(c)&&(u[u.indexOf(c)]=h);n.set(f,c=h)}c.push(t),this.fastupdate&&((h=this.reg.get(t))?h.push(c):this.reg.set(t,[c]))}}}if(this.store&&(!i||!this.store.has(t))){let l;if(this.C){l=P();for(let o=0,f;o<this.C.length;o++){if(f=this.C[o],(i=f.I)&&!i(e))continue;let c;if(typeof f=="function"){if(c=f(e),!c)continue;f=[f.V]}else if($(f)||f.constructor===String){l[f]=e[f];continue}Bt(e,l,f,0,f[0],c)}}this.store.set(t,l||e)}this.worker&&(this.fastupdate||this.reg.add(t))}return this};function Bt(t,e,i,s,n,r){if(t=t[n],s===i.length-1)e[n]=r||t;else if(t)if(t.constructor===Array)for(e=e[n]=Array(t.length),n=0;n<t.length;n++)Bt(t,e,i,s,n);else e=e[n]||(e[n]=P()),n=i[++s],Bt(t,e,i,s,n)}function It(t,e,i,s,n,r,h,l){if(t=t[h])if(s===e.length-1){if(t.constructor===Array){if(i[s]){for(e=0;e<t.length;e++)n.add(r,t[e],!0,!0);return}t=t.join(" ")}n.add(r,t,l,!0)}else if(t.constructor===Array)for(h=0;h<t.length;h++)It(t,e,i,s,n,r,h,l);else h=e[++s],It(t,e,i,s,n,r,h,l);else n.db&&n.remove(r)}function ve(t,e,i,s,n,r,h){const l=t.length;let o=[],f,c;f=P();for(let u=0,g,a,d,p;u<e;u++)for(let m=0;m<l;m++)if(d=t[m],u<d.length&&(g=d[u]))for(let v=0;v<g.length;v++){if(a=g[v],(c=f[a])?f[a]++:(c=0,f[a]=1),p=o[c]||(o[c]=[]),!h){let x=u+(m||!n?0:r||0);p=p[x]||(p[x]=[])}if(p.push(a),h&&i&&c===l-1&&p.length-s===i)return s?p.slice(s):p}if(t=o.length)if(n)o=1<o.length?xe(o,i,s,h,r):(o=o[0]).length>i||s?o.slice(s,i+s):o;else{if(t<l)return[];if(o=o[t-1],i||s)if(h)(o.length>i||s)&&(o=o.slice(s,i+s));else{n=[];for(let u=0,g;u<o.length;u++)if(g=o[u],g.length>s)s-=g.length;else if((g.length>i||s)&&(g=g.slice(s,i+s),i-=g.length,s&&(s-=g.length)),n.push(g),!i)break;o=1<n.length?[].concat.apply([],n):n[0]}}return o}function xe(t,e,i,s,n){const r=[],h=P();let l;var o=t.length;let f;if(s){for(n=o-1;0<=n;n--)if(f=(s=t[n])&&s.length){for(o=0;o<f;o++)if(l=s[o],!h[l]){if(h[l]=1,i)i--;else if(r.push(l),r.length===e)return r}}}else for(let c=o-1,u,g=0;0<=c;c--){u=t[c];for(let a=0;a<u.length;a++)if(f=(s=u[a])&&s.length){for(let d=0;d<f;d++)if(l=s[d],!h[l])if(h[l]=1,i)i--;else{let p=(a+(c<o-1&&n||0))/(c+1)|0;if((r[p]||(r[p]=[])).push(l),++g===e)return r}}}return r}function mi(t,e,i){const s=P(),n=[];for(let r=0,h;r<e.length;r++){h=e[r];for(let l=0;l<h.length;l++)s[h[l]]=1}if(i)for(let r=0,h;r<t.length;r++)h=t[r],s[h]&&(n.push(h),s[h]=0);else for(let r=0,h,l;r<t.result.length;r++)for(h=t.result[r],e=0;e<h.length;e++)l=h[e],s[l]&&((n[r]||(n[r]=[])).push(l),s[l]=0);return n}function Rt(t,e,i,s){if(!t.length)return t;if(t.length===1)return t=t[0],t=i||t.length>e?e?t.slice(i,i+e):t.slice(i):t,s?F.call(this,t):t;let n=[];for(let r=0,h,l;r<t.length;r++)if((h=t[r])&&(l=h.length)){if(i){if(i>=l){i-=l;continue}i<l&&(h=e?h.slice(i,i+e):h.slice(i),l=h.length,i=0)}if(l>e&&(h=h.slice(0,e),l=e),!n.length&&l>=e)return s?F.call(this,h):h;if(n.push(h),e-=l,!e)break}return n=1<n.length?[].concat.apply([],n):n[0],s?F.call(this,n):n}function yt(t,e,i){var s=i[0];if(s.then)return Promise.all(i).then(function(c){return t[e].apply(t,c)});if(s[0]&&s[0].index)return t[e].apply(t,s);s=[];let n=[],r=0,h=0,l,o,f;for(let c=0,u;c<i.length;c++)if(u=i[c]){let g;if(u.constructor===S)g=u.result;else if(u.constructor===Array)g=u;else if(r=u.limit||0,h=u.offset||0,f=u.suggest,o=u.resolve,l=u.enrich&&o,u.index)u.resolve=!1,g=u.index.search(u).result,u.resolve=o;else if(u.and)g=t.and(u.and);else if(u.or)g=t.or(u.or);else if(u.xor)g=t.xor(u.xor);else if(u.not)g=t.not(u.not);else continue;if(g.then)n.push(g);else if(g.length)s[c]=g;else if(!f&&(e==="and"||e==="xor")){s=[];break}}return{O:s,P:n,limit:r,offset:h,enrich:l,resolve:o,suggest:f}}S.prototype.or=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r}=yt(this,"or",arguments);return ke.call(this,t,e,i,s,n,r)};function ke(t,e,i,s,n,r){if(e.length){const h=this;return Promise.all(e).then(function(l){t=[];for(let o=0,f;o<l.length;o++)(f=l[o]).length&&(t[o]=f);return ke.call(h,t,[],i,s,n,r)})}return t.length&&(this.result.length&&t.push(this.result),2>t.length?this.result=t[0]:(this.result=xe(t,i,s,!1,this.h),s=0)),r?this.resolve(i,s,n):this}S.prototype.and=function(){let t=this.result.length,e,i,s,n;if(!t){const r=arguments[0];r&&(t=!!r.suggest,n=r.resolve,e=r.limit,i=r.offset,s=r.enrich&&n)}if(t){const{O:r,P:h,limit:l,offset:o,enrich:f,resolve:c,suggest:u}=yt(this,"and",arguments);return _e.call(this,r,h,l,o,f,c,u)}return n?this.resolve(e,i,s):this};function _e(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let f=0,c;f<o.length;f++)(c=o[f]).length&&(t[f]=c);return _e.call(l,t,[],i,s,n,r,h)})}if(t.length)if(this.result.length&&t.unshift(this.result),2>t.length)this.result=t[0];else{if(e=li(t))return this.result=ve(t,e,i,s,h,this.h,r),r?n?F.call(this.index,this.result):this.result:this;this.result=[]}else h||(this.result=t);return r?this.resolve(i,s,n):this}S.prototype.xor=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r,suggest:h}=yt(this,"xor",arguments);return ze.call(this,t,e,i,s,n,r,h)};function ze(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let f=0,c;f<o.length;f++)(c=o[f]).length&&(t[f]=c);return ze.call(l,t,[],i,s,n,r,h)})}if(t.length)if(this.result.length&&t.unshift(this.result),2>t.length)this.result=t[0];else return this.result=wi.call(this,t,i,s,r,this.h),r?n?F.call(this.index,this.result):this.result:this;else h||(this.result=t);return r?this.resolve(i,s,n):this}function wi(t,e,i,s,n){const r=[],h=P();let l=0;for(let o=0,f;o<t.length;o++)if(f=t[o]){l<f.length&&(l=f.length);for(let c=0,u;c<f.length;c++)if(u=f[c])for(let g=0,a;g<u.length;g++)a=u[g],h[a]=h[a]?2:1}for(let o=0,f,c=0;o<l;o++)for(let u=0,g;u<t.length;u++)if((g=t[u])&&(f=g[o])){for(let a=0,d;a<f.length;a++)if(d=f[a],h[d]===1)if(i)i--;else if(s){if(r.push(d),r.length===e)return r}else{const p=o+(u?n:0);if(r[p]||(r[p]=[]),r[p].push(d),++c===e)return r}}return r}S.prototype.not=function(){const{O:t,P:e,limit:i,offset:s,enrich:n,resolve:r,suggest:h}=yt(this,"not",arguments);return Me.call(this,t,e,i,s,n,r,h)};function Me(t,e,i,s,n,r,h){if(e.length){const l=this;return Promise.all(e).then(function(o){t=[];for(let f=0,c;f<o.length;f++)(c=o[f]).length&&(t[f]=c);return Me.call(l,t,[],i,s,n,r,h)})}if(t.length&&this.result.length)this.result=yi.call(this,t,i,s,r);else if(r)return this.resolve(i,s,n);return r?n?F.call(this.index,this.result):this.result:this}function yi(t,e,i,s){const n=[];t=new Set(t.flat().flat());for(let r=0,h,l=0;r<this.result.length;r++)if(h=this.result[r]){for(let o=0,f;o<h.length;o++)if(f=h[o],!t.has(f)){if(i)i--;else if(s){if(n.push(f),n.length===e)return n}else if(n[r]||(n[r]=[]),n[r].push(f),++l===e)return n}}return n}function S(t){if(!this||this.constructor!==S)return new S(t);if(t&&t.index)return t.resolve=!1,this.index=t.index,this.h=t.boost||0,this.result=t.index.search(t).result,this;this.index=null,this.result=t||[],this.h=0}S.prototype.limit=function(t){if(this.result.length){const e=[];for(let i=0,s;i<this.result.length;i++)if(s=this.result[i])if(s.length<=t){if(e[i]=s,t-=s.length,!t)break}else{e[i]=s.slice(0,t);break}this.result=e}return this};S.prototype.offset=function(t){if(this.result.length){const e=[];for(let i=0,s;i<this.result.length;i++)(s=this.result[i])&&(s.length<=t?t-=s.length:(e[i]=s.slice(t),t=0));this.result=e}return this};S.prototype.boost=function(t){return this.h+=t,this};S.prototype.resolve=function(t,e,i){const s=this.result,n=this.index;return this.result=this.index=null,s.length?(typeof t=="object"&&(i=t.enrich,e=t.offset,t=t.limit),Rt.call(n,s,t||100,e,i)):s};tt.prototype.search=function(t,e,i,s){i||(!e&&ht(t)?(i=t,t=""):ht(e)&&(i=e,e=0));let n=[];var r=[],h;let l,o,f,c=0;var u=!0;let g;if(i){i.constructor===Array&&(i={index:i}),t=i.query||t;var a=i.pluck;l=i.merge,o=a||i.field||(o=i.index)&&(o.index?null:o),f=this.tag&&i.tag;var d=i.suggest;u=i.resolve!==!1,u||a||!(o=o||this.field)||($(o)?a=o:(o.constructor===Array&&o.length===1&&(o=o[0]),a=o.field||o.index)),g=(h=this.store&&i.enrich&&u)&&i.highlight,e=i.limit||e;var p=i.offset||0;if(e||(e=100),f&&(!this.db||!s)){f.constructor!==Array&&(f=[f]);var m=[];for(let _=0,y;_<f.length;_++)if(y=f[_],y.field&&y.tag){var v=y.tag;if(v.constructor===Array)for(var x=0;x<v.length;x++)m.push(y.field,v[x]);else m.push(y.field,v)}else{v=Object.keys(y);for(let z=0,j,M;z<v.length;z++)if(j=v[z],M=y[j],M.constructor===Array)for(x=0;x<M.length;x++)m.push(j,M[x]);else m.push(j,M)}if(f=m,!t){if(u=[],m.length)for(r=0;r<m.length;r+=2){if(this.db){if(a=this.index.get(m[r]),!a)continue;u.push(a=a.db.tag(m[r+1],e,p,h))}else a=vi.call(this,m[r],m[r+1],e,p,h);n.push({field:m[r],tag:m[r+1],result:a})}return u.length?Promise.all(u).then(function(_){for(let y=0;y<_.length;y++)n[y].result=_[y];return n}):n}}o&&o.constructor!==Array&&(o=[o])}o||(o=this.field),m=!s&&(this.worker||this.db)&&[];let A;for(let _=0,y,z,j;_<o.length;_++){if(z=o[_],this.db&&this.tag&&!this.D[_])continue;let M;if($(z)||(M=z,z=M.field,t=M.query||t,e=M.limit||e,p=M.offset||p,d=M.suggest||d,h=this.store&&(M.enrich||h)),s)y=s[_];else if(v=M||i,x=this.index.get(z),f&&(this.db&&(v.tag=f,A=x.db.support_tag_search,v.field=o),A||(v.enrich=!1)),m){m[_]=x.search(t,e,v),v&&h&&(v.enrich=h);continue}else y=x.search(t,e,v),v&&h&&(v.enrich=h);if(j=y&&(u?y.length:y.result.length),f&&j){if(v=[],x=0,this.db&&s){if(!A)for(let I=o.length;I<s.length;I++){let C=s[I];if(C&&C.length)x++,v.push(C);else if(!d)return u?n:new S(n)}}else for(let I=0,C,et;I<f.length;I+=2){if(C=this.tag.get(f[I]),!C){if(d)continue;return u?n:new S(n)}if(et=(C=C&&C.get(f[I+1]))&&C.length)x++,v.push(C);else if(!d)return u?n:new S(n)}if(x){if(y=mi(y,v,u),j=y.length,!j&&!d)return u?y:new S(y);x--}}if(j)r[c]=z,n.push(y),c++;else if(o.length===1)return u?n:new S(n)}if(m){if(this.db&&f&&f.length&&!A)for(h=0;h<f.length;h+=2){if(r=this.index.get(f[h]),!r){if(d)continue;return u?n:new S(n)}m.push(r.db.tag(f[h+1],e,p,!1))}const _=this;return Promise.all(m).then(function(y){return y.length?_.search(t,e,i,y):y})}if(!c)return u?n:new S(n);if(a&&(!h||!this.store))return n[0];for(m=[],p=0;p<r.length;p++){if(d=n[p],h&&d.length&&typeof d[0].doc>"u"&&(this.db?m.push(d=this.index.get(this.field[0]).db.enrich(d)):d=F.call(this,d)),a)return u?d:new S(d);n[p]={field:r[p],result:d}}if(h&&this.db&&m.length){const _=this;return Promise.all(m).then(function(y){for(let z=0;z<y.length;z++)n[z].result=y[z];return l?ie(n):g?ee(n,t,_.index,_.field,_.D,g):n})}return l?ie(n):g?ee(n,t,this.index,this.field,this.D,g):n};function ee(t,e,i,s,n,r){let h,l,o;for(let f=0,c,u,g,a;f<t.length;f++){if(c=t[f].field,!c)continue;let d=t[f].result;g=i.get(c),u=g.encoder,o=g.tokenize,a=n[s.indexOf(c)],u!==h&&(h=u,l=h.encode(e));for(let p=0;p<d.length;p++){let m="",v=ot(d[p].doc,a).split(/\s+/);for(let x=0,A,_;x<v.length;x++){A=v[x],_=u.encode(A),_=1<_.length?_.join(" "):_[0];let y;if(_&&A)for(let z=0,j;z<l.length;z++)if(j=l[z],o==="strict"){if(_===j){m+=(m?" ":"")+r.replace("$1",A),y=!0;break}}else{const M=_.indexOf(j);if(-1<M){m+=(m?" ":"")+A.substring(0,M)+r.replace("$1",A.substring(M,j.length))+A.substring(M+j.length),y=!0;break}}y||(m+=(m?" ":"")+v[x])}d[p].highlight=m}}return t}function ie(t){const e=[],i=P();for(let s=0,n,r;s<t.length;s++){n=t[s],r=n.result;for(let h=0,l,o,f;h<r.length;h++)o=r[h],typeof o!="object"&&(o={id:o}),l=o.id,(f=i[l])?f.push(n.field):(o.field=i[l]=[n.field],e.push(o))}return e}function vi(t,e,i,s,n){if(t=this.tag.get(t),!t)return[];if((e=(t=t&&t.get(e))&&t.length-s)&&0<e)return(e>i||s)&&(t=t.slice(s,s+i)),n&&(t=F.call(this,t)),t}function F(t){if(!this||!this.store)return t;const e=Array(t.length);for(let i=0,s;i<t.length;i++)s=t[i],e[i]={id:s,doc:this.store.get(s)};return e}function tt(t){if(!this||this.constructor!==tt)return new tt(t);const e=t.document||t.doc||t;let i,s;if(this.D=[],this.field=[],this.J=[],this.key=(i=e.key||e.id)&&mt(i,this.J)||"id",(s=t.keystore||0)&&(this.keystore=s),this.fastupdate=!!t.fastupdate,this.reg=!this.fastupdate||t.worker||t.db?s?new q(s):new Set:s?new R(s):new Map,this.C=(i=e.store||null)&&i&&i!==!0&&[],this.store=i&&(s?new R(s):new Map),this.cache=(i=t.cache||null)&&new U(i),t.cache=!1,this.worker=t.worker,this.priority=t.priority||4,this.index=xi.call(this,t,e),this.tag=null,(i=e.tag)&&(typeof i=="string"&&(i=[i]),i.length)){this.tag=new Map,this.F=[],this.R=[];for(let n=0,r,h;n<i.length;n++){if(r=i[n],h=r.field||r,!h)throw Error("The tag field from the document descriptor is undefined.");r.custom?this.F[n]=r.custom:(this.F[n]=mt(h,this.J),r.filter&&(typeof this.F[n]=="string"&&(this.F[n]=new String(this.F[n])),this.F[n].I=r.filter)),this.R[n]=h,this.tag.set(h,new Map)}}if(this.worker){this.fastupdate=!1,t=[];for(const n of this.index.values())n.then&&t.push(n);if(t.length){const n=this;return Promise.all(t).then(function(r){let h=0;for(const l of n.index.entries()){const o=l[0];l[1].then&&n.index.set(o,r[h++])}return n})}}else t.db&&(this.fastupdate=!1,this.mount(t.db))}w=tt.prototype;w.mount=function(t){let e=this.field;if(this.tag)for(let n=0,r;n<this.R.length;n++){r=this.R[n];var i=void 0;this.index.set(r,i=new T({},this.reg)),e===this.field&&(e=e.slice(0)),e.push(r),i.tag=this.tag.get(r)}i=[];const s={db:t.db,type:t.type,fastupdate:t.fastupdate};for(let n=0,r,h;n<e.length;n++){s.field=h=e[n],r=this.index.get(h);const l=new t.constructor(t.id,s);l.id=t.id,i[n]=l.mount(r),r.document=!0,n?r.bypass=!0:r.store=this.store}return this.db=!0,Promise.all(i)};w.commit=async function(t,e){const i=[];for(const s of this.index.values())i.push(s.commit(t,e));await Promise.all(i),this.reg.clear()};w.destroy=function(){const t=[];for(const e of this.index.values())t.push(e.destroy());return Promise.all(t)};function xi(t,e){const i=new Map;let s=e.index||e.field||e;$(s)&&(s=[s]);for(let n=0,r,h;n<s.length;n++){if(r=s[n],$(r)||(h=r,r=r.field),h=ht(h)?Object.assign({},t,h):t,this.worker){const l=new lt(h);i.set(r,l)}this.worker||i.set(r,new T(h,this.reg)),h.custom?this.D[n]=h.custom:(this.D[n]=mt(r,this.J),h.filter&&(typeof this.D[n]=="string"&&(this.D[n]=new String(this.D[n])),this.D[n].I=h.filter)),this.field[n]=r}if(this.C){t=e.store,$(t)&&(t=[t]);for(let n=0,r,h;n<t.length;n++)r=t[n],h=r.field||r,r.custom?(this.C[n]=r.custom,r.custom.V=h):(this.C[n]=mt(h,this.J),r.filter&&(typeof this.C[n]=="string"&&(this.C[n]=new String(this.C[n])),this.C[n].I=r.filter))}return i}function mt(t,e){const i=t.split(":");let s=0;for(let n=0;n<i.length;n++)t=i[n],t[t.length-1]==="]"&&(t=t.substring(0,t.length-2))&&(e[s]=!0),t&&(i[s++]=t);return s<i.length&&(i.length=s),1<s?i:i[0]}w.append=function(t,e){return this.add(t,e,!0)};w.update=function(t,e){return this.remove(t).add(t,e)};w.remove=function(t){ht(t)&&(t=ot(t,this.key));for(var e of this.index.values())e.remove(t,!0);if(this.reg.has(t)){if(this.tag&&!this.fastupdate)for(let i of this.tag.values())for(let s of i){e=s[0];const n=s[1],r=n.indexOf(t);-1<r&&(1<n.length?n.splice(r,1):i.delete(e))}this.store&&this.store.delete(t),this.reg.delete(t)}return this.cache&&this.cache.remove(t),this};w.clear=function(){const t=[];for(const e of this.index.values()){const i=e.clear();i.then&&t.push(i)}if(this.tag)for(const e of this.tag.values())e.clear();return this.store&&this.store.clear(),this.cache&&this.cache.clear(),t.length?Promise.all(t):this};w.contain=function(t){return this.db?this.index.get(this.field[0]).db.has(t):this.reg.has(t)};w.cleanup=function(){for(const t of this.index.values())t.cleanup();return this};w.get=function(t){return this.db?this.index.get(this.field[0]).db.enrich(t).then(function(e){return e[0]&&e[0].doc||null}):this.store.get(t)||null};w.set=function(t,e){return typeof t=="object"&&(e=t,t=ot(e,this.key)),this.store.set(t,e),this};w.searchCache=Se;w.export=function(t,e,i=0,s=0){if(i<this.field.length){const h=this.field[i];if((e=this.index.get(h).export(t,h,i,s=1))&&e.then){const l=this;return e.then(function(){return l.export(t,h,i+1)})}return this.export(t,h,i+1)}let n,r;switch(s){case 0:n="reg",r=pe(this.reg),e=null;break;case 1:n="tag",r=this.tag&&de(this.tag,this.reg.size),e=null;break;case 2:n="doc",r=this.store&&qt(this.store),e=null;break;default:return}return pt.call(this,t,e,n,r,i,s)};w.import=function(t,e){var i=t.split(".");i[i.length-1]==="json"&&i.pop();const s=2<i.length?i[0]:"";if(i=2<i.length?i[2]:i[1],this.worker&&s)return this.index.get(s).import(t);if(e){if(typeof e=="string"&&(e=JSON.parse(e)),s)return this.index.get(s).import(i,e);switch(i){case"reg":this.fastupdate=!1,this.reg=me(e,this.reg);for(let n=0,r;n<this.field.length;n++)r=this.index.get(this.field[n]),r.fastupdate=!1,r.reg=this.reg;if(this.worker){e=[];for(const n of this.index.values())e.push(n.import(t));return Promise.all(e)}break;case"tag":this.tag=ge(e,this.tag);break;case"doc":this.store=Tt(e,this.store)}}};$t(tt.prototype);function Se(t,e,i){t=(typeof t=="object"?""+t.query:t).toLowerCase(),this.cache||(this.cache=new U);let s=this.cache.get(t);if(!s){if(s=this.search(t,e,i),s.then){const n=this;s.then(function(r){return n.cache.set(t,r),r})}this.cache.set(t,s)}return s}function U(t){this.limit=t&&t!==!0?t:1e3,this.cache=new Map,this.h=""}U.prototype.set=function(t,e){this.cache.set(this.h=t,e),this.cache.size>this.limit&&this.cache.delete(this.cache.keys().next().value)};U.prototype.get=function(t){const e=this.cache.get(t);return e&&this.h!==t&&(this.cache.delete(t),this.cache.set(this.h=t,e)),e};U.prototype.remove=function(t){for(const e of this.cache){const i=e[0];e[1].includes(t)&&this.cache.delete(i)}};U.prototype.clear=function(){this.cache.clear(),this.h=""};const ne={normalize:!1,numeric:!1,dedupe:!1},ct={},jt=new Map([["b","p"],["v","f"],["w","f"],["z","s"],["x","s"],["d","t"],["n","m"],["c","k"],["g","k"],["j","k"],["q","k"],["i","e"],["y","e"],["u","o"]]),se=new Map([["ae","a"],["oe","o"],["sh","s"],["kh","k"],["th","t"],["ph","f"],["pf","f"]]),re=[/([^aeo])h(.)/g,"$1$2",/([aeo])h([^aeo]|$)/g,"$1$2",/(.)\1+/g,"$1"],he={a:"",e:"",i:"",o:"",u:"",y:"",b:1,f:1,p:1,v:1,c:2,g:2,j:2,k:2,q:2,s:2,x:2,z:2,ß:2,d:3,t:3,l:4,m:5,n:5,r:6};var ki={Exact:ne,Default:ct,Normalize:ct,LatinBalance:{mapper:jt},LatinAdvanced:{mapper:jt,matcher:se,replacer:re},LatinExtra:{mapper:jt,replacer:re.concat([/(?!^)[aeo]/g,""]),matcher:se},LatinSoundex:{dedupe:!1,include:{letter:!0},finalize:function(t){for(let i=0;i<t.length;i++){var e=t[i];let s=e.charAt(0),n=he[s];for(let r=1,h;r<e.length&&(h=e.charAt(r),h==="h"||h==="w"||!(h=he[h])||h===n||(s+=h,n=h,s.length!==4));r++);t[i]=s}}},LatinExact:ne,LatinDefault:ct,LatinSimple:ct};T.prototype.remove=function(t,e){const i=this.reg.size&&(this.fastupdate?this.reg.get(t):this.reg.has(t));if(i){if(this.fastupdate){for(let s=0,n;s<i.length;s++)if(n=i[s])if(2>n.length)n.pop();else{const r=n.indexOf(t);r===i.length-1?n.pop():n.splice(r,1)}}else ft(this.map,t),this.depth&&ft(this.ctx,t);e||this.reg.delete(t)}return this.db&&(this.commit_task.push({del:t}),this.T&&je(this)),this.cache&&this.cache.remove(t),this};function ft(t,e){let i=0;var s=typeof e>"u";if(t.constructor===Array){for(let n=0,r,h;n<t.length;n++)if((r=t[n])&&r.length)if(s)i++;else if(h=r.indexOf(e),0<=h){1<r.length?(r.splice(h,1),i++):delete t[n];break}else i++}else for(let n of t.entries()){s=n[0];const r=ft(n[1],e);r?i+=r:t.delete(s)}return i}const _i={memory:{resolution:1},performance:{resolution:3,fastupdate:!0,context:{depth:1,resolution:1}},match:{tokenize:"forward"},score:{resolution:9,context:{depth:2,resolution:3}}};T.prototype.add=function(t,e,i,s){if(e&&(t||t===0)){if(!s&&!i&&this.reg.has(t))return this.update(t,e);if(e=this.encoder.encode(e),s=e.length){const f=P(),c=P(),u=this.depth,g=this.resolution;for(let a=0;a<s;a++){let d=e[this.rtl?s-1-a:a];var n=d.length;if(n&&(u||!c[d])){var r=this.score?this.score(e,d,a,null,0):at(g,s,a),h="";switch(this.tokenize){case"full":if(2<n){for(let p=0,m;p<n;p++)for(r=n;r>p;r--){h=d.substring(p,r),m=this.rtl?n-1-p:p;var l=this.score?this.score(e,d,a,h,m):at(g,s,a,n,m);rt(this,c,h,l,t,i)}break}case"bidirectional":case"reverse":if(1<n){for(l=n-1;0<l;l--){h=d[this.rtl?n-1-l:l]+h;var o=this.score?this.score(e,d,a,h,l):at(g,s,a,n,l);rt(this,c,h,o,t,i)}h=""}case"forward":if(1<n){for(l=0;l<n;l++)h+=d[this.rtl?n-1-l:l],rt(this,c,h,r,t,i);break}default:if(rt(this,c,d,r,t,i),u&&1<s&&a<s-1){for(n=P(),h=this.U,r=d,l=Math.min(u+1,this.rtl?a+1:s-a),n[r]=1,o=1;o<l;o++)if((d=e[this.rtl?s-1-a-o:a+o])&&!n[d]){n[d]=1;const p=this.score?this.score(e,r,a,d,o-1):at(h+(s/2>h?0:1),s,a,l-1,o-1),m=this.bidirectional&&d>r;rt(this,f,m?r:d,p,t,i,m?d:r)}}}}}this.fastupdate||this.reg.add(t)}else e=""}return this.db&&(e||this.commit_task.push({del:t}),this.T&&je(this)),this};function rt(t,e,i,s,n,r,h){let l=h?t.ctx:t.map,o;if((!e[i]||h&&!(o=e[i])[h])&&(h?(e=o||(e[i]=P()),e[h]=1,(o=l.get(h))?l=o:l.set(h,l=new Map)):e[i]=1,(o=l.get(i))?l=o:l.set(i,l=o=[]),l=l[s]||(l[s]=[]),!r||!l.includes(n))){if(l.length===2**31-1){if(e=new G(l),t.fastupdate)for(let f of t.reg.values())f.includes(l)&&(f[f.indexOf(l)]=e);o[s]=l=e}l.push(n),t.fastupdate&&((s=t.reg.get(n))?s.push(l):t.reg.set(n,[l]))}}function at(t,e,i,s,n){return i&&1<t?e+(s||0)<=t?i+(n||0):(t-1)/(e+(s||0))*(i+(n||0))+1|0:0}T.prototype.search=function(t,e,i){i||(e||typeof t!="object"?typeof e=="object"&&(i=e,e=0):(i=t,t=""));let s=[],n,r,h,l=0,o,f,c,u,g;i?(t=i.query||t,e=i.limit||e,l=i.offset||0,r=i.context,h=i.suggest,g=(o=i.resolve!==!1)&&i.enrich,c=i.boost,u=i.resolution,f=this.db&&i.tag):o=this.resolve;let a=this.encoder.encode(t);if(n=a.length,e=e||(o?100:0),n===1)return le.call(this,a[0],"",e,l,o,g,f);if(r=this.depth&&r!==!1,n===2&&r&&!h)return le.call(this,a[1],a[0],e,l,o,g,f);let d=P(),p=0,m;if(r&&(m=a[0],p=1),u||u===0||(u=m?this.U:this.resolution),this.db){if(this.db.search&&(t=this.db.search(this,a,e,l,h,o,g,f),t!==!1))return t;const v=this;return async function(){for(let x,A;p<n;p++){if((A=a[p])&&!d[A]){if(d[A]=1,x=await Et(v,A,m,0,0,!1,!1),x=fe(x,s,h,u)){s=x;break}m&&(h&&x&&s.length||(m=A))}h&&m&&p===n-1&&!s.length&&(u=v.resolution,m="",p=-1,d=P())}return oe(s,u,e,l,h,c,o)}()}for(let v,x;p<n;p++){if((x=a[p])&&!d[x]){if(d[x]=1,v=Et(this,x,m,0,0,!1,!1),v=fe(v,s,h,u)){s=v;break}m&&(h&&v&&s.length||(m=x))}h&&m&&p===n-1&&!s.length&&(u=this.resolution,m="",p=-1,d=P())}return oe(s,u,e,l,h,c,o)};function oe(t,e,i,s,n,r,h){let l=t.length,o=t;if(1<l)o=ve(t,e,i,s,n,r,h);else if(l===1)return h?Rt.call(null,t[0],i,s):new S(t[0]);return h?o:new S(o)}function le(t,e,i,s,n,r,h){return t=Et(this,t,e,i,s,n,r,h),this.db?t.then(function(l){return n?l||[]:new S(l)}):t&&t.length?n?Rt.call(this,t,i,s):new S(t):n?[]:new S}function fe(t,e,i,s){let n=[];if(t&&t.length){if(t.length<=s){e.push(t);return}for(let r=0,h;r<s;r++)(h=t[r])&&(n[r]=h);if(n.length){e.push(n);return}}if(!i)return n}function Et(t,e,i,s,n,r,h,l){let o;return i&&(o=t.bidirectional&&e>i)&&(o=i,i=e,e=o),t.db?t.db.get(e,i,s,n,r,h,l):(t=i?(t=t.ctx.get(i))&&t.get(e):t.map.get(e),t)}function T(t,e){if(!this||this.constructor!==T)return new T(t);if(t){var i=$(t)?t:t.preset;i&&(t=Object.assign({},_i[i],t))}else t={};i=t.context;const s=i===!0?{depth:1}:i||{},n=$(t.encoder)?ki[t.encoder]:t.encode||t.encoder||{};this.encoder=n.encode?n:typeof n=="object"?new gt(n):{encode:n},this.resolution=t.resolution||9,this.tokenize=i=(i=t.tokenize)&&i!=="default"&&i!=="exact"&&i||"strict",this.depth=i==="strict"&&s.depth||0,this.bidirectional=s.bidirectional!==!1,this.fastupdate=!!t.fastupdate,this.score=t.score||null,(i=t.keystore||0)&&(this.keystore=i),this.map=i?new R(i):new Map,this.ctx=i?new R(i):new Map,this.reg=e||(this.fastupdate?i?new R(i):new Map:i?new q(i):new Set),this.U=s.resolution||3,this.rtl=n.rtl||t.rtl||!1,this.cache=(i=t.cache||null)&&new U(i),this.resolve=t.resolve!==!1,(i=t.db)&&(this.db=this.mount(i)),this.T=t.commit!==!1,this.commit_task=[],this.commit_timer=null,this.priority=t.priority||4}w=T.prototype;w.mount=function(t){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),t.mount(this)};w.commit=function(t,e){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.commit(this,t,e)};w.destroy=function(){return this.commit_timer&&(clearTimeout(this.commit_timer),this.commit_timer=null),this.db.destroy()};function je(t){t.commit_timer||(t.commit_timer=setTimeout(function(){t.commit_timer=null,t.db.commit(t,void 0,void 0)},1))}w.clear=function(){return this.map.clear(),this.ctx.clear(),this.reg.clear(),this.cache&&this.cache.clear(),this.db&&(this.commit_timer&&clearTimeout(this.commit_timer),this.commit_timer=null,this.commit_task=[{clear:!0}]),this};w.append=function(t,e){return this.add(t,e,!0)};w.contain=function(t){return this.db?this.db.has(t):this.reg.has(t)};w.update=function(t,e){const i=this,s=this.remove(t);return s&&s.then?s.then(()=>i.add(t,e)):this.add(t,e)};w.cleanup=function(){return this.fastupdate?(ft(this.map),this.depth&&ft(this.ctx),this):this};w.searchCache=Se;w.export=function(t,e,i=0,s=0){let n,r;switch(s){case 0:n="reg",r=pe(this.reg);break;case 1:n="cfg",r=null;break;case 2:n="map",r=qt(this.map,this.reg.size);break;case 3:n="ctx",r=de(this.ctx,this.reg.size);break;default:return}return pt.call(this,t,e,n,r,i,s)};w.import=function(t,e){if(e)switch(typeof e=="string"&&(e=JSON.parse(e)),t=t.split("."),t[t.length-1]==="json"&&t.pop(),t.length===3&&t.shift(),t=1<t.length?t[1]:t[0],t){case"reg":this.fastupdate=!1,this.reg=me(e,this.reg);break;case"map":this.map=Tt(e,this.map);break;case"ctx":this.ctx=ge(e,this.ctx)}};w.serialize=function(t=!0){let e="",i="",s="";if(this.reg.size){let r;for(var n of this.reg.keys())r||(r=typeof n),e+=(e?",":"")+(r==="string"?'"'+n+'"':n);e="index.reg=new Set(["+e+"]);",i=Yt(this.map,r),i="index.map=new Map(["+i+"]);";for(const h of this.ctx.entries()){n=h[0];let l=Yt(h[1],r);l="new Map(["+l+"])",l='["'+n+'",'+l+"]",s+=(s?",":"")+l}s="index.ctx=new Map(["+s+"]);"}return t?"function inject(index){"+e+i+s+"}":e+i+s};$t(T.prototype);const Ae=typeof window<"u"&&(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB),wt=["map","ctx","tag","reg","cfg"],K=P();function Pe(t,e={}){if(!this)return new Pe(t,e);typeof t=="object"&&(e=t,t=t.name),t||console.info("Default storage space was used, because a name was not passed."),this.id="flexsearch"+(t?":"+t.toLowerCase().replace(/[^a-z0-9_\-]/g,""):""),this.field=e.field?e.field.toLowerCase().replace(/[^a-z0-9_\-]/g,""):"",this.type=e.type,this.fastupdate=this.support_tag_search=!1,this.db=null,this.h={}}w=Pe.prototype;w.mount=function(t){return t.encoder?(t.db=this,this.open()):t.mount(this)};w.open=function(){if(this.db)return this.db;let t=this;navigator.storage&&navigator.storage.persist(),K[t.id]||(K[t.id]=[]),K[t.id].push(t.field);const e=Ae.open(t.id,1);return e.onupgradeneeded=function(){const i=t.db=this.result;for(let s=0,n;s<wt.length;s++){n=wt[s];for(let r=0,h;r<K[t.id].length;r++)h=K[t.id][r],i.objectStoreNames.contains(n+(n!=="reg"&&h?":"+h:""))||i.createObjectStore(n+(n!=="reg"&&h?":"+h:""))}},t.db=H(e,function(i){t.db=i,t.db.onversionchange=function(){t.close()}})};w.close=function(){this.db&&this.db.close(),this.db=null};w.destroy=function(){const t=Ae.deleteDatabase(this.id);return H(t)};w.clear=function(){const t=[];for(let i=0,s;i<wt.length;i++){s=wt[i];for(let n=0,r;n<K[this.id].length;n++)r=K[this.id][n],t.push(s+(s!=="reg"&&r?":"+r:""))}const e=this.db.transaction(t,"readwrite");for(let i=0;i<t.length;i++)e.objectStore(t[i]).clear();return H(e)};w.get=function(t,e,i=0,s=0,n=!0,r=!1){t=this.db.transaction((e?"ctx":"map")+(this.field?":"+this.field:""),"readonly").objectStore((e?"ctx":"map")+(this.field?":"+this.field:"")).get(e?e+":"+t:t);const h=this;return H(t).then(function(l){let o=[];if(!l||!l.length)return o;if(n){if(!i&&!s&&l.length===1)return l[0];for(let f=0,c;f<l.length;f++)if((c=l[f])&&c.length){if(s>=c.length){s-=c.length;continue}const u=i?s+Math.min(c.length-s,i):c.length;for(let g=s;g<u;g++)o.push(c[g]);if(s=0,o.length===i)break}return r?h.enrich(o):o}return l})};w.tag=function(t,e=0,i=0,s=!1){t=this.db.transaction("tag"+(this.field?":"+this.field:""),"readonly").objectStore("tag"+(this.field?":"+this.field:"")).get(t);const n=this;return H(t).then(function(r){return!r||!r.length||i>=r.length?[]:!e&&!i?r:(r=r.slice(i,i+e),s?n.enrich(r):r)})};w.enrich=function(t){typeof t!="object"&&(t=[t]);const e=this.db.transaction("reg","readonly").objectStore("reg"),i=[];for(let s=0;s<t.length;s++)i[s]=H(e.get(t[s]));return Promise.all(i).then(function(s){for(let n=0;n<s.length;n++)s[n]={id:t[n],doc:s[n]?JSON.parse(s[n]):null};return s})};w.has=function(t){return t=this.db.transaction("reg","readonly").objectStore("reg").getKey(t),H(t).then(function(e){return!!e})};w.search=null;w.info=function(){};w.transaction=function(t,e,i){t+=t!=="reg"&&this.field?":"+this.field:"";let s=this.h[t+":"+e];if(s)return i.call(this,s);let n=this.db.transaction(t,e);this.h[t+":"+e]=s=n.objectStore(t);const r=i.call(this,s);return this.h[t+":"+e]=null,H(n).finally(function(){return n=s=null,r})};w.commit=async function(t,e,i){if(e)await this.clear(),t.commit_task=[];else{let s=t.commit_task;t.commit_task=[];for(let n=0,r;n<s.length;n++)if(r=s[n],r.clear){await this.clear(),e=!0;break}else s[n]=r.del;e||(i||(s=s.concat(oi(t.reg))),s.length&&await this.remove(s))}t.reg.size&&(await this.transaction("map","readwrite",function(s){for(const n of t.map){const r=n[0],h=n[1];h.length&&(e?s.put(h,r):s.get(r).onsuccess=function(){let l=this.result;var o;if(l&&l.length){const f=Math.max(l.length,h.length);for(let c=0,u,g;c<f;c++)if((g=h[c])&&g.length){if((u=l[c])&&u.length)for(o=0;o<g.length;o++)u.push(g[o]);else l[c]=g;o=1}}else l=h,o=1;o&&s.put(l,r)})}}),await this.transaction("ctx","readwrite",function(s){for(const n of t.ctx){const r=n[0],h=n[1];for(const l of h){const o=l[0],f=l[1];f.length&&(e?s.put(f,r+":"+o):s.get(r+":"+o).onsuccess=function(){let c=this.result;var u;if(c&&c.length){const g=Math.max(c.length,f.length);for(let a=0,d,p;a<g;a++)if((p=f[a])&&p.length){if((d=c[a])&&d.length)for(u=0;u<p.length;u++)d.push(p[u]);else c[a]=p;u=1}}else c=f,u=1;u&&s.put(c,r+":"+o)})}}}),t.store?await this.transaction("reg","readwrite",function(s){for(const n of t.store){const r=n[0],h=n[1];s.put(typeof h=="object"?JSON.stringify(h):1,r)}}):t.bypass||await this.transaction("reg","readwrite",function(s){for(const n of t.reg.keys())s.put(1,n)}),t.tag&&await this.transaction("tag","readwrite",function(s){for(const n of t.tag){const r=n[0],h=n[1];h.length&&(s.get(r).onsuccess=function(){let l=this.result;l=l&&l.length?l.concat(h):h,s.put(l,r)})}}),t.map.clear(),t.ctx.clear(),t.tag&&t.tag.clear(),t.store&&t.store.clear(),t.document||t.reg.clear())};function At(t,e,i){const s=t.value;let n,r=0;for(let h=0,l;h<s.length;h++){if(l=i?s:s[h]){for(let o=0,f,c;o<e.length;o++)if(c=e[o],f=l.indexOf(c),0<=f)if(n=1,1<l.length)l.splice(f,1);else{s[h]=[];break}r+=l.length}if(i)break}r?n&&t.update(s):t.delete(),t.continue()}w.remove=function(t){return typeof t!="object"&&(t=[t]),Promise.all([this.transaction("map","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&At(i,t)}}),this.transaction("ctx","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&At(i,t)}}),this.transaction("tag","readwrite",function(e){e.openCursor().onsuccess=function(){const i=this.result;i&&At(i,t,!0)}}),this.transaction("reg","readwrite",function(e){for(let i=0;i<t.length;i++)e.delete(t[i])})])};function H(t,e){return new Promise((i,s)=>{t.onsuccess=t.oncomplete=function(){e&&e(this.result),e=null,i(this.result)},t.onerror=t.onblocked=s,t=null})}const Ce={Index:T};let Ot=new Ce.Index({tokenize:"forward"}),Le;function zi(t){Ot=new Ce.Index({tokenize:"forward"});const e=t.map(i=>({slug:i.slug,title:i.title,excerpt:i.excerpt||"",tags:i.tags}));e.forEach((i,s)=>{const n=`${i.title} ${i.excerpt} ${i.tags}`;Ot.add(s,n)}),Le=e}function Mi(t){if(!t)return[];const e=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return Ot.search(e).map(s=>Le[s]).map(({slug:s,title:n="",excerpt:r="",tags:h=[]})=>({slug:s,title:Dt(n,e),content:Si(r,e),tags:h.map(l=>Dt(l,e))}))}function Dt(t,e){if(!t)return"";if(!e)return t;const i=new RegExp(e,"gi");return t.replaceAll(i,s=>`<mark>${s}</mark>`)}function Si(t,e,i=1){if(!e)return[];const s=new RegExp(e,"gi"),n=[];let r=0,h;for(;(h=s.exec(t))!==null&&r<i;)n.push(h.index),r++;return n.map(l=>{const o=Math.max(0,l-20),f=Math.min(t.length,l+80),c=t.substring(o,f).trim();return`...${Dt(c,e)}...`})}var ji=b('<div class="input-wrapper svelte-9owzg4"><div class="svelte-9owzg4"><input type="text" placeholder="Type to filter articles..." class="svelte-9owzg4"></div> <div class="svelte-9owzg4"><!></div></div>'),Ai=b('<p class="tag svelte-9owzg4"><!></p>'),Pi=b('<li class="svelte-9owzg4"><a class="svelte-9owzg4"><div><div><!></div> <div><p class="svelte-9owzg4"><!></p></div></div> <div class="tag-container svelte-9owzg4"></div></a></li>'),Ci=b('<ul class="svelte-9owzg4"></ul>'),Li=b('<div class="dropdown svelte-9owzg4"><!></div>'),Bi=b('<div class="search-bar-container svelte-9owzg4"><!> <!></div>');function Ii(t,e){ue(e,!1);const[i,s]=Ye(),n=()=>ti(ei,"$theme",i);let r=Vt(e,"searchTerm",12,""),h=Vt(e,"blogPosts",24,()=>[]),l=it(!0),o=it(null),f=it(!1),c=it("loading"),u=it([]);function g(y){const z=y.target;r(z.value),D(f,r().length>0)}function a(){r(""),D(f,!1),D(l,!1)}function d(y){k(o)&&!k(o).contains(y.target)&&D(f,!1)}function p(y){y.key==="Escape"&&D(f,!1)}ii(async()=>{zi(h()),D(c,"ready"),typeof window<"u"&&(window.addEventListener("click",d),window.addEventListener("keydown",p))}),ni(()=>{typeof window<"u"&&(window.removeEventListener("click",d),window.removeEventListener("keydown",p))}),Kt(()=>(k(l),k(o),Wt),()=>{k(l)&&k(o)&&Wt().then(()=>{var y;(y=k(o))==null||y.focus()})}),Kt(()=>(k(c),k(u),be(r())),()=>{k(c)==="ready"&&(D(u,Mi(r())),D(f,k(u).length>0))}),Je(),Xe();var m=Bi(),v=E(m);{var x=y=>{var z=ji(),j=E(z),M=E(j);Ue(M),Qe(M,O=>D(o,O),()=>k(o)),B(j);var I=X(j,2),C=E(I);{var et=O=>{Zt(O,{icon:"heroicons:magnifying-glass-16-solid",width:"28",height:"28",style:"color: #ffffff;"})},V=O=>{Zt(O,{icon:"heroicons:magnifying-glass-16-solid",width:"28",height:"28",style:"color: #121212;"})};Q(C,O=>{n()==="dark"?O(et):O(V,!1)})}B(I),B(z),hi(M,r),Ut("input",M,g),N(y,z)};Q(v,y=>{k(l)&&y(x)})}var A=X(v,2);{var _=y=>{var z=Li(),j=E(z);{var M=I=>{var C=Ci();Pt(C,5,()=>k(u),Ct,(et,V)=>{var O=Pi(),ut=E(O),vt=E(ut),xt=E(vt),Be=E(xt);zt(Be,()=>k(V).title,!1,!1),B(xt);var Nt=X(xt,2),Ft=E(Nt),Ie=E(Ft);zt(Ie,()=>k(V).content,!1,!1),B(Ft),B(Nt),B(vt);var bt=X(vt,2);Pt(bt,5,()=>k(V).tags,Ct,(Ee,Jt)=>{var Ht=qe(),Oe=ae(Ht);{var De=kt=>{var _t=Ai(),$e=E(_t);zt($e,()=>k(Jt),!1,!1),B(_t),N(kt,_t)};Q(Oe,kt=>{k(Jt).toLowerCase().includes(r().toLowerCase())&&kt(De)})}N(Ee,Ht)}),B(bt),B(ut),B(O),He(()=>Ve(ut,"href",`/blog/${k(V).slug??""}`)),Ut("click",ut,a),N(et,O)}),B(C),N(I,C)};Q(j,I=>{k(u).length>0&&I(M)})}B(z),N(y,z)};Q(A,y=>{k(c)==="ready"&&k(f)&&y(_)})}B(m),N(t,m),ce(),s()}var Ei=b('<div class="grid svelte-1vcc8ph"></div>'),Oi=b('<!> <div class="header svelte-1vcc8ph"><!></div> <!>',1);function Yi(t,e){ue(e,!0);let{allPosts:i=[]}=e.data||{},s=Gt(""),n=Gt(Ke([]));i&&i.length>0&&D(n,i.filter(r=>{const h=(r==null?void 0:r.title)??"",l=(r==null?void 0:r.contributor)??"",o=(r==null?void 0:r.excerpt)??"";return h.toLowerCase().includes(k(s).toLowerCase())||l.toLowerCase().includes(k(s).toLowerCase())||o.toLowerCase().includes(k(s).toLowerCase())}),!0),ri(t,{children:(r,h)=>{var l=Oi(),o=ae(l);si(o,{title:"Blog"});var f=X(o,2),c=E(f);Ii(c,{blogPosts:i,get searchTerm(){return k(s)},set searchTerm(a){D(s,a,!0)}}),B(f);var u=X(f,2);{var g=a=>{var d=Ei();Pt(d,21,()=>k(n),Ct,(p,m)=>{We(p,{get post_data(){return k(m)}})}),B(d),N(a,d)};Q(u,a=>{k(n)&&k(n).length>0&&a(g)})}N(r,l)}}),ce()}export{Yi as component};
